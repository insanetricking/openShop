class Slider {
  constructor() {
    this.sliderInner = document.querySelector('.slider__inner');
    this.sliderLine = this.sliderInner.querySelector('.slider__line');
    this.sliderSlides = [...this.sliderLine.querySelectorAll('.slider__slide')];
    this.sliderPagination = this.sliderInner.querySelector('.slider__pagination');
    this.sliderRounds = [...this.sliderInner.querySelectorAll('.slider__round')];
    this.count = 0;
    this.x1 = null;
    this.y1 = null; //////////////////////// Click//////////////////////////

    this.init();
    window.addEventListener('resize', () => {
      this.init();
    });
    this.sliderPagination.addEventListener('click', e => {
      this.change(e);
    }); //////////////////////// Interval//////////////////////////

    this.intervalId = setInterval(() => {
      this.autoClick();
    }, 3000);
    this.sliderPagination.addEventListener('mouseover', () => {
      clearInterval(this.intervalId);
    });
    this.sliderPagination.addEventListener('mouseout', () => {
      this.intervalId = setInterval(() => {
        this.autoClick();
      }, 3000);
    }); //////////////////////// Touch//////////////////////////

    this.sliderInner.addEventListener('touchstart', e => {
      this.handleTouchStart(e);
      clearInterval(this.intervalId);
    }, false);
    this.sliderInner.addEventListener('touchmove', e => {
      this.handleTouchMove(e);
    }, false);
  }

  init() {
    this.width = this.sliderInner.offsetWidth;
    this.sliderLine.style.width = this.width * this.sliderSlides.length + 'px';
    this.sliderSlides.forEach(item => {
      item.style.width = this.width + 'px';
      item.style.height = 'auto';
    });
  }

  change(e) {
    if (e.target != this.sliderPagination) {
      this.sliderRounds.forEach((btn, index) => {
        btn.classList.remove('active');

        if (e.target === btn) {
          this.count = index;
          this.translate();
        }
      });
    }
  }

  translate() {
    this.sliderRounds[this.count].classList.add('active');
    this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
  }

  autoClick() {
    this.sliderRounds.forEach(btn => {
      btn.classList.remove('active');
    });
    this.count++;

    if (this.count >= this.sliderRounds.length) {
      this.count = 0;
      this.translate();
    } else {
      this.translate();
    }
  }

  handleTouchStart(e) {
    let touch = e.touches[0];
    this.x1 = touch.clientX;
    this.y1 = touch.clientY;
  }

  handleTouchMove(e) {
    if (!(this.x1 || this.y1)) {
      return false;
    }

    let touch = e.touches[0];
    let x2 = touch.clientX;
    let y2 = touch.clientY;
    let xDiff = x2 - this.x1;
    let yDiff = y2 - this.y1; // console.log(this.x1, x2);

    if (xDiff > 0) {
      //r
      this.sliderRounds.forEach(btn => {
        btn.classList.remove('active');
      });
      this.count--;

      if (this.count < 0) {
        this.count = this.sliderRounds.length - 1;
        this.sliderRounds[this.count].classList.add('active');
        this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
      }

      this.sliderRounds[this.count].classList.add('active');
      this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
    } else {
      //l
      this.autoClick();
    }

    this.x1 = null;
    this.y1 = null;
  }

}

let slider = new Slider();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNsaWRlci5qcyJdLCJuYW1lcyI6WyJTbGlkZXIiLCJjb25zdHJ1Y3RvciIsInNsaWRlcklubmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic2xpZGVyTGluZSIsInNsaWRlclNsaWRlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzbGlkZXJQYWdpbmF0aW9uIiwic2xpZGVyUm91bmRzIiwiY291bnQiLCJ4MSIsInkxIiwiaW5pdCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2hhbmdlIiwiaW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiYXV0b0NsaWNrIiwiY2xlYXJJbnRlcnZhbCIsImhhbmRsZVRvdWNoU3RhcnQiLCJoYW5kbGVUb3VjaE1vdmUiLCJ3aWR0aCIsIm9mZnNldFdpZHRoIiwic3R5bGUiLCJsZW5ndGgiLCJmb3JFYWNoIiwiaXRlbSIsImhlaWdodCIsInRhcmdldCIsImJ0biIsImluZGV4IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidHJhbnNsYXRlIiwiYWRkIiwidHJhbnNmb3JtIiwidG91Y2giLCJ0b3VjaGVzIiwiY2xpZW50WCIsImNsaWVudFkiLCJ4MiIsInkyIiwieERpZmYiLCJ5RGlmZiIsInNsaWRlciJdLCJtYXBwaW5ncyI6IkFBQ0EsTUFBQUEsTUFBQSxDQUFBO0FBQ0FDLEVBQUFBLFdBQUEsR0FBQTtBQUNBLFNBQUFDLFdBQUEsR0FBQUMsUUFBQSxDQUFBQyxhQUFBLENBQUEsZ0JBQUEsQ0FBQTtBQUNBLFNBQUFDLFVBQUEsR0FBQSxLQUFBSCxXQUFBLENBQUFFLGFBQUEsQ0FBQSxlQUFBLENBQUE7QUFDQSxTQUFBRSxZQUFBLEdBQUEsQ0FBQSxHQUFBLEtBQUFELFVBQUEsQ0FBQUUsZ0JBQUEsQ0FBQSxnQkFBQSxDQUFBLENBQUE7QUFDQSxTQUFBQyxnQkFBQSxHQUFBLEtBQUFOLFdBQUEsQ0FBQUUsYUFBQSxDQUFBLHFCQUFBLENBQUE7QUFDQSxTQUFBSyxZQUFBLEdBQUEsQ0FBQSxHQUFBLEtBQUFQ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QUEsQ0FBQSxFQUFBO0FBQ0EsYUFBQUEsS0FBQSxHQUFBLEtBQUFELFlBQUEsQ0FBQWtCLE1BQUEsR0FBQSxDQUFBO0FBRUEsYUFBQWxCLFlBQUEsQ0FBQSxLQUFBQyxLQUFBLEVBQUF3QixTQUFBLENBQUFHLEdBQUEsQ0FBQSxRQUFBO0FBQ0EsYUFBQWhDLFVBQUEsQ0FBQXFCLEtBQUEsQ0FBQVksU0FBQSxHQUFBLGVBQUEsS0FBQTVCLEtBQUEsR0FBQSxLQUFBYyxLQUFBLEtBQUE7QUFFQTs7QUFDQSxXQUFBZixZQUFBLENBQUEsS0FBQUMsS0FBQSxFQUFBd0IsU0FBQSxDQUFBRyxHQUFBLENBQUEsUUFBQTtBQUNBLFdBQUFoQyxVQUFBLENBQUFxQixLQUFBLENBQUFZLFNBQUEsR0FBQSxlQUFBLEtBQUE1QixLQUFBLEdBQUEsS0FBQWMsS0FBQSxLQUFBO0FBR0EsS0FuQkEsTUFtQkE7QUFDQTtBQUVBLFdBQUFKLFNBQUE7QUFDQTs7QUFHQSxTQUFBVCxFQUFBLEdBQUEsSUFBQTtBQUNBLFNBQUFDLEVBQUEsR0FBQSxJQUFBO0FBQ0E7O0FBcktBOztBQXdLQSxJQUFBbUMsTUFBQSxHQUFBLElBQUEvQyxNQUFBLEVBQUEiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5jbGFzcyBTbGlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJJbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX2lubmVyJyk7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lID0gdGhpcy5zbGlkZXJJbm5lci5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19saW5lJyk7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJTbGlkZXMgPSBbLi4udGhpcy5zbGlkZXJMaW5lLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZXJfX3NsaWRlJyldO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyUGFnaW5hdGlvbiA9IHRoaXMuc2xpZGVySW5uZXIucXVlcnlTZWxlY3RvcignLnNsaWRlcl9fcGFnaW5hdGlvbicpO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzID0gWy4uLnRoaXMuc2xpZGVySW5uZXIucXVlcnlTZWxlY3RvckFsbCgnLnNsaWRlcl9fcm91bmQnKV07XHJcblxyXG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLngxID0gbnVsbDtcclxuICAgICAgICB0aGlzLnkxID0gbnVsbDtcclxuXHJcblxyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ2xpY2svLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgIHRoaXMuaW5pdCgpXHJcblxyXG5cclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyUGFnaW5hdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlKGUpXHJcbiAgICAgICAgfSlcclxuXHJcblxyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBJbnRlcnZhbC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hdXRvQ2xpY2soKTtcclxuICAgICAgICB9LCAzMDAwKTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyUGFnaW5hdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuc2xpZGVyUGFnaW5hdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRvQ2xpY2soKTtcclxuICAgICAgICAgICAgfSwgMzAwMCk7XHJcbiAgICAgICAgfSlcclxuXHJcblxyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBUb3VjaC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVySW5uZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlVG91Y2hTdGFydChlKTtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJJbm5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZVRvdWNoTW92ZShlKTtcclxuICAgICAgICB9LCBmYWxzZSk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5zbGlkZXJJbm5lci5vZmZzZXRXaWR0aDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUud2lkdGggPSB0aGlzLndpZHRoICogdGhpcy5zbGlkZXJTbGlkZXMubGVuZ3RoICsgJ3B4JztcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJTbGlkZXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgICBpdGVtLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcclxuXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2UoZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldCAhPSB0aGlzLnNsaWRlclBhZ2luYXRpb24pIHtcclxuXHJcblxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kcy5mb3JFYWNoKChidG4sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSBidG4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB0cmFuc2xhdGUoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzW3RoaXMuY291bnRdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7dGhpcy5jb3VudCAqIHRoaXMud2lkdGh9cHgpYDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgYXV0b0NsaWNrKCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY291bnQrKztcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY291bnQgPj0gdGhpcy5zbGlkZXJSb3VuZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY291bnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVUb3VjaFN0YXJ0KGUpIHtcclxuXHJcbiAgICAgICAgbGV0IHRvdWNoID0gZS50b3VjaGVzWzBdO1xyXG4gICAgICAgIHRoaXMueDEgPSB0b3VjaC5jbGllbnRYO1xyXG4gICAgICAgIHRoaXMueTEgPSB0b3VjaC5jbGllbnRZO1xyXG5cclxuXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVG91Y2hNb3ZlKGUpIHtcclxuXHJcbiAgICAgICAgaWYgKCEodGhpcy54MSB8fCB0aGlzLnkxKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB0b3VjaCA9IGUudG91Y2hlc1swXTtcclxuXHJcbiAgICAgICAgbGV0IHgyID0gdG91Y2guY2xpZW50WDtcclxuICAgICAgICBsZXQgeTIgPSB0b3VjaC5jbGllbnRZO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGxldCB4RGlmZiA9IHgyIC0gdGhpcy54MTtcclxuICAgICAgICBsZXQgeURpZmYgPSB5MiAtIHRoaXMueTE7XHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueDEsIHgyKTtcclxuXHJcbiAgICAgICAgaWYgKHhEaWZmID4gMCkge1xyXG4gICAgICAgICAgICAvL3JcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVyUm91bmRzLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY291bnQtLTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5zbGlkZXJSb3VuZHMubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHt0aGlzLmNvdW50ICogdGhpcy53aWR0aH1weClgO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3RoaXMuY291bnQgKiB0aGlzLndpZHRofXB4KWA7XHJcblxyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL2xcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0NsaWNrKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy54MSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy55MSA9IG51bGw7XHJcbiAgICB9XHJcbn1cclxuXHJcbmxldCBzbGlkZXIgPSBuZXcgU2xpZGVyKCk7Il19
