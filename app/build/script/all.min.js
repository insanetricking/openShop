class Heart {
  constructor() {
    this.hearts = [...document.querySelectorAll('.cards__heart')];
    this.hearts.forEach(heart => {
      heart.addEventListener('click', e => {
        this.change(e, heart);
      });
    });
  }

  change(e) {
    if (e.target.dataset.flag === 'true') {
      e.target.src = '../images/heart.svg';
      e.target.dataset.flag = false;
    } else {
      e.target.setAttribute('data-flag', true);
      e.target.src = '../images/heartRed.svg';
    }
  }

}

const heart = new Heart();

class ImageSwitcher {
  constructor(obj) {
    this.imageItems = [...document.querySelectorAll(obj.imageItems)];
    this.miniImages = [...document.querySelectorAll(obj.miniImages)];
    this.images = [...document.querySelectorAll(obj.images)];
    this.current = 0;
    this.imageItems.forEach(item => {
      item.addEventListener('click', e => {
        this.switch(e);
      });
    });
  }

  switch(e) {
    this.imageItems.forEach(item => {
      item.classList.remove('active');
    });
    this.images.forEach(item => {
      item.classList.remove('active');
    });
    this.current = this.miniImages.indexOf(e.target);
    this.imageItems[this.current].classList.add('active');
    this.images[this.current].classList.add('active');
  }

}

const imageSwitcher = new ImageSwitcher({
  imageItems: '.item__box-item',
  images: '.item__mainImg',
  miniImages: '.item__miniImg'
});

class Slider {
  constructor() {
    this.sliderInner = document.querySelector('.slider__inner');
    this.sliderLine = this.sliderInner.querySelector('.slider__line');
    this.sliderSlides = [...this.sliderLine.querySelectorAll('.slider__slide')];
    this.sliderPagination = this.sliderInner.querySelector('.slider__pagination');
    this.sliderRounds = [...this.sliderInner.querySelectorAll('.slider__round')];
    this.count = 0;
    this.x1 = null;
    this.y1 = null; //////////////////////// Click//////////////////////////

    this.init();
    window.addEventListener('resize', () => {
      this.init();
    });
    this.sliderPagination.addEventListener('click', e => {
      this.change(e);
    }); //////////////////////// Interval//////////////////////////

    this.intervalId = this.interval();
    this.sliderPagination.addEventListener('mouseover', () => {
      clearInterval(this.intervalId);
    });
    this.sliderPagination.addEventListener('mouseout', () => {
      this.intervalId = setInterval(() => {
        this.autoClick();
      }, 3000);
    }); //////////////////////// Touch//////////////////////////

    this.sliderInner.addEventListener('touchstart', e => {
      this.handleTouchStart(e);
      clearInterval(this.intervalId);
    }, false);
    this.sliderInner.addEventListener('touchmove', e => {
      this.handleTouchMove(e);
    }, false);
  }

  init() {
    this.width = this.sliderInner.offsetWidth;
    this.sliderLine.style.width = this.width * this.sliderSlides.length + 'px';
    this.sliderSlides.forEach(item => {
      item.style.width = this.width + 'px';
      item.style.height = 'auto';
    });
  }

  change(e) {
    if (e.target != this.sliderPagination) {
      this.sliderRounds.forEach((btn, index) => {
        btn.classList.remove('active');

        if (e.target === btn) {
          this.count = index;
          this.translate();
        }
      });
    }
  }

  translate() {
    this.sliderRounds[this.count].classList.add('active');
    this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
  }

  autoClick() {
    this.sliderRounds.forEach(btn => {
      btn.classList.remove('active');
    });
    this.count++;

    if (this.count >= this.sliderRounds.length) {
      this.count = 0;
      this.translate();
    } else {
      this.translate();
    }
  }

  handleTouchStart(e) {
    let touch = e.touches[0];
    this.x1 = touch.clientX;
    this.y1 = touch.clientY;
  }

  handleTouchMove(e) {
    if (!(this.x1 || this.y1)) {
      return false;
    }

    let touch = e.touches[0];
    let x2 = touch.clientX;
    let y2 = touch.clientY;
    let xDiff = x2 - this.x1;
    let yDiff = y2 - this.y1; // console.log(this.x1, x2);

    if (xDiff > 0) {
      //r
      this.sliderRounds.forEach(btn => {
        btn.classList.remove('active');
      });
      this.count--;

      if (this.count < 0) {
        this.count = this.sliderRounds.length - 1;
        this.sliderRounds[this.count].classList.add('active');
        this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
      }

      this.sliderRounds[this.count].classList.add('active');
      this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
    } else {
      //l
      this.autoClick();
    }

    this.x1 = null;
    this.y1 = null;
    this.intervalId = this.interval();
  }

  interval() {
    let id = setInterval(() => {
      this.autoClick();
    }, 3000);
    return id;
  }

}

let slider = new Slider();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2ZUhlYXJ0LmpzIiwiaW1hZ2VTd2l0Y2hlci5qcyIsInNsaWRlci5qcyJdLCJuYW1lcyI6WyJIZWFydCIsImNvbnN0cnVjdG9yIiwiaGVhcnRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImhlYXJ0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJjaGFuZ2UiLCJ0YXJnZXQiLCJkYXRhc2V0IiwiZmxhZyIsInNyYyIsInNldEF0dHJpYnV0ZSIsIkltYWdlU3dpdGNoZXIiLCJvYmoiLCJpbWFnZUl0ZW1zIiwibWluaUltYWdlcyIsImltYWdlcyIsImN1cnJlbnQiLCJpdGVtIiwic3dpdGNoIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaW5kZXhPZiIsImFkZCIsImltYWdlU3dpdGNoZXIiLCJTbGlkZXIiLCJzbGlkZXJJbm5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzbGlkZXJMaW5lIiwic2xpZGVyU2xpZGVzIiwic2xpZGVyUGFnaW5hdGlvbiIsInNsaWRlclJvdW5kcyIsImNvdW50IiwieDEiLCJ5MSIsImluaXQiLCJ3aW5kb3ciLCJpbnRlcnZhbElkIiwiaW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJhdXRvQ2xpY2siLCJoYW5kbGVUb3VjaFN0YXJ0IiwiaGFuZGxlVG91Y2hNb3ZlIiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsInN0eWxlIiwibGVuZ3RoIiwiaGVpZ2h0IiwiYnRuIiwiaW5kZXgiLCJ0cmFuc2xhdGUiLCJ0cmFuc2Zvcm0iLCJ0b3VjaCIsInRvdWNoZXMiLCJjbGllbnRYIiwiY2xpZW50WSIsIngyIiwieTIiLCJ4RGlmZiIsInlEaWZmIiwiaWQiLCJzbGlkZXIiXSwibWFwcGluZ3MiOiJBQUNBLE1BQUFBLEtBQUEsQ0FBQTtBQUNBQyxFQUFBQSxXQUFBLEdBQUE7QUFDQSxTQUFBQyxNQUFBLEdBQUEsQ0FBQSxHQUFBQyxRQUFBLENBQUFDLGdCQUFBLENBQUEsZUFBQSxDQUFBLENB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Q0FBQTdCLE9BQUEsQ0FBQStDLEdBQUEsSUFBQTtBQUNBQSxRQUFBQSxHQUFBLENBQUE3QixTQUFBLENBQUFDLE1BQUEsQ0FBQSxRQUFBO0FBQ0EsT0FGQTtBQUlBLFdBQUFXLEtBQUE7O0FBQ0EsVUFBQSxLQUFBQSxLQUFBLEdBQUEsQ0FBQSxFQUFBO0FBQ0EsYUFBQUEsS0FBQSxHQUFBLEtBQUFELFlBQUEsQ0FBQWdCLE1BQUEsR0FBQSxDQUFBO0FBRUEsYUFBQWhCLFlBQUEsQ0FBQSxLQUFBQyxLQUFBLEVBQUFaLFNBQUEsQ0FBQUcsR0FBQSxDQUFBLFFBQUE7QUFDQSxhQUFBSyxVQUFBLENBQUFrQixLQUFBLENBQUFNLFNBQUEsR0FBQSxlQUFBLEtBQUFwQixLQUFBLEdBQUEsS0FBQVksS0FBQSxLQUFBO0FBRUE7O0FBQ0EsV0FBQWIsWUFBQSxDQUFBLEtBQUFDLEtBQUEsRUFBQVosU0FBQSxDQUFBRyxHQUFBLENBQUEsUUFBQTtBQUNBLFdBQUFLLFVBQUEsQ0FBQWtCLEtBQUEsQ0FBQU0sU0FBQSxHQUFBLGVBQUEsS0FBQXBCLEtBQUEsR0FBQSxLQUFBWSxLQUFBLEtBQUE7QUFHQSxLQW5CQSxNQW1CQTtBQUNBO0FBRUEsV0FBQUgsU0FBQTtBQUNBOztBQUdBLFNBQUFSLEVBQUEsR0FBQSxJQUFBO0FBQ0EsU0FBQUMsRUFBQSxHQUFBLElBQUE7QUFFQSxTQUFBRyxVQUFBLEdBQUEsS0FBQUMsUUFBQSxFQUFBO0FBQ0E7O0FBR0FBLEVBQUFBLFFBQUEsR0FBQTtBQUNBLFFBQUF1QixFQUFBLEdBQUFyQixXQUFBLENBQUEsTUFBQTtBQUNBLFdBQUFDLFNBQUE7QUFDQSxLQUZBLEVBRUEsSUFGQSxDQUFBO0FBSUEsV0FBQW9CLEVBQUE7QUFDQTs7QUEvS0E7O0FBa0xBLElBQUFDLE1BQUEsR0FBQSxJQUFBckMsTUFBQSxFQUFBIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuY2xhc3MgSGVhcnQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5oZWFydHMgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhcmRzX19oZWFydCcpXTtcclxuXHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLmhlYXJ0cy5mb3JFYWNoKGhlYXJ0ID0+e1xyXG4gICAgICAgICAgICBoZWFydC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZShlLCBoZWFydCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2UoZSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKGUudGFyZ2V0LmRhdGFzZXQuZmxhZyA9PT0gJ3RydWUnKXtcclxuICAgICAgICAgICAgZS50YXJnZXQuc3JjPSAnLi4vaW1hZ2VzL2hlYXJ0LnN2ZydcclxuICAgICAgICAgICAgZS50YXJnZXQuZGF0YXNldC5mbGFnID0gZmFsc2U7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnNldEF0dHJpYnV0ZSgnZGF0YS1mbGFnJywgdHJ1ZSlcclxuICAgICAgICAgICAgZS50YXJnZXQuc3JjPSAnLi4vaW1hZ2VzL2hlYXJ0UmVkLnN2ZydcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5jb25zdCBoZWFydCA9IG5ldyBIZWFydCgpO1xyXG4iLCJjbGFzcyBJbWFnZVN3aXRjaGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG9iaikge1xyXG4gICAgICAgIHRoaXMuaW1hZ2VJdGVtcyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9iai5pbWFnZUl0ZW1zKV07XHJcbiAgICAgICAgdGhpcy5taW5pSW1hZ2VzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob2JqLm1pbmlJbWFnZXMpXTtcclxuICAgICAgICB0aGlzLmltYWdlcyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9iai5pbWFnZXMpXTtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5pbWFnZUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3dpdGNoKGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzd2l0Y2goZSkge1xyXG5cclxuICAgICAgICB0aGlzLmltYWdlSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmltYWdlcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSB0aGlzLm1pbmlJbWFnZXMuaW5kZXhPZihlLnRhcmdldCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW1hZ2VJdGVtc1t0aGlzLmN1cnJlbnRdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHRoaXMuaW1hZ2VzW3RoaXMuY3VycmVudF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcblxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5jb25zdCBpbWFnZVN3aXRjaGVyID0gbmV3IEltYWdlU3dpdGNoZXIoXHJcbiAgICB7XHJcbiAgICAgICAgaW1hZ2VJdGVtczogJy5pdGVtX19ib3gtaXRlbScsXHJcbiAgICAgICAgaW1hZ2VzOiAnLml0ZW1fX21haW5JbWcnLFxyXG4gICAgICAgIG1pbmlJbWFnZXM6ICcuaXRlbV9fbWluaUltZycsXHJcbiAgICB9XHJcbikiLCJcclxuY2xhc3MgU2xpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVySW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19pbm5lcicpO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZSA9IHRoaXMuc2xpZGVySW5uZXIucXVlcnlTZWxlY3RvcignLnNsaWRlcl9fbGluZScpO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyU2xpZGVzID0gWy4uLnRoaXMuc2xpZGVyTGluZS5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19zbGlkZScpXTtcclxuICAgICAgICB0aGlzLnNsaWRlclBhZ2luYXRpb24gPSB0aGlzLnNsaWRlcklubmVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX3BhZ2luYXRpb24nKTtcclxuICAgICAgICB0aGlzLnNsaWRlclJvdW5kcyA9IFsuLi50aGlzLnNsaWRlcklubmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZXJfX3JvdW5kJyldO1xyXG5cclxuICAgICAgICB0aGlzLmNvdW50ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy54MSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy55MSA9IG51bGw7XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIENsaWNrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgICAgICB0aGlzLmluaXQoKVxyXG5cclxuXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pbml0KClcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICB0aGlzLnNsaWRlclBhZ2luYXRpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZShlKVxyXG4gICAgICAgIH0pXHJcblxyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gSW50ZXJ2YWwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgICAgICB0aGlzLmludGVydmFsSWQgPSB0aGlzLmludGVydmFsKCk7IFxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJQYWdpbmF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5zbGlkZXJQYWdpbmF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9DbGljaygpO1xyXG4gICAgICAgICAgICB9LCAzMDAwKTtcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFRvdWNoLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJJbm5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVUb3VjaFN0YXJ0KGUpO1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XHJcbiAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlcklubmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlVG91Y2hNb3ZlKGUpO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIHRoaXMud2lkdGggPSB0aGlzLnNsaWRlcklubmVyLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKiB0aGlzLnNsaWRlclNsaWRlcy5sZW5ndGggKyAncHgnO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlclNsaWRlcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgICBpdGVtLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcclxuXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2UoZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldCAhPSB0aGlzLnNsaWRlclBhZ2luYXRpb24pIHtcclxuXHJcblxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kcy5mb3JFYWNoKChidG4sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSBidG4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB0cmFuc2xhdGUoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzW3RoaXMuY291bnRdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7dGhpcy5jb3VudCAqIHRoaXMud2lkdGh9cHgpYDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgYXV0b0NsaWNrKCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY291bnQrKztcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY291bnQgPj0gdGhpcy5zbGlkZXJSb3VuZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY291bnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVUb3VjaFN0YXJ0KGUpIHtcclxuXHJcbiAgICAgICAgbGV0IHRvdWNoID0gZS50b3VjaGVzWzBdO1xyXG4gICAgICAgIHRoaXMueDEgPSB0b3VjaC5jbGllbnRYO1xyXG4gICAgICAgIHRoaXMueTEgPSB0b3VjaC5jbGllbnRZO1xyXG5cclxuXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVG91Y2hNb3ZlKGUpIHtcclxuXHJcbiAgICAgICAgaWYgKCEodGhpcy54MSB8fCB0aGlzLnkxKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB0b3VjaCA9IGUudG91Y2hlc1swXTtcclxuXHJcbiAgICAgICAgbGV0IHgyID0gdG91Y2guY2xpZW50WDtcclxuICAgICAgICBsZXQgeTIgPSB0b3VjaC5jbGllbnRZO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGxldCB4RGlmZiA9IHgyIC0gdGhpcy54MTtcclxuICAgICAgICBsZXQgeURpZmYgPSB5MiAtIHRoaXMueTE7XHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueDEsIHgyKTtcclxuXHJcbiAgICAgICAgaWYgKHhEaWZmID4gMCkge1xyXG4gICAgICAgICAgICAvL3JcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVyUm91bmRzLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY291bnQtLTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5zbGlkZXJSb3VuZHMubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHt0aGlzLmNvdW50ICogdGhpcy53aWR0aH1weClgO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3RoaXMuY291bnQgKiB0aGlzLndpZHRofXB4KWA7XHJcblxyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL2xcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0NsaWNrKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy54MSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy55MSA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gdGhpcy5pbnRlcnZhbCgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpbnRlcnZhbCgpe1xyXG4gICAgICBsZXQgaWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0NsaWNrKCk7XHJcbiAgICAgICAgfSwgMzAwMCk7XHJcblxyXG4gICAgICAgIHJldHVybiBpZDtcclxuICAgIH1cclxufVxyXG5cclxubGV0IHNsaWRlciA9IG5ldyBTbGlkZXIoKTsiXX0=
