class Slider {
  constructor() {
    this.sliderInner = document.querySelector('.slider__inner');
    this.sliderLine = this.sliderInner.querySelector('.slider__line');
    this.sliderSlides = [...this.sliderLine.querySelectorAll('.slider__slide')];
    this.sliderPagination = this.sliderInner.querySelector('.slider__pagination');
    this.sliderRounds = [...this.sliderInner.querySelectorAll('.slider__round')];
    this.count = 0;
    this.x1 = null;
    this.y1 = null; //////////////////////// Click//////////////////////////

    this.init();
    window.addEventListener('resize', () => {
      this.init();
    });
    this.sliderPagination.addEventListener('click', e => {
      this.change(e);
    }); //////////////////////// Interval//////////////////////////

    this.intervalId = this.interval();
    this.sliderPagination.addEventListener('mouseover', () => {
      clearInterval(this.intervalId);
    });
    this.sliderPagination.addEventListener('mouseout', () => {
      this.intervalId = setInterval(() => {
        this.autoClick();
      }, 3000);
    }); //////////////////////// Touch//////////////////////////

    this.sliderInner.addEventListener('touchstart', e => {
      this.handleTouchStart(e);
      clearInterval(this.intervalId);
    }, false);
    this.sliderInner.addEventListener('touchmove', e => {
      this.handleTouchMove(e);
    }, false);
  }

  init() {
    this.width = this.sliderInner.offsetWidth;
    this.sliderLine.style.width = this.width * this.sliderSlides.length + 'px';
    this.sliderSlides.forEach(item => {
      item.style.width = this.width + 'px';
      item.style.height = 'auto';
    });
  }

  change(e) {
    if (e.target != this.sliderPagination) {
      this.sliderRounds.forEach((btn, index) => {
        btn.classList.remove('active');

        if (e.target === btn) {
          this.count = index;
          this.translate();
        }
      });
    }
  }

  translate() {
    this.sliderRounds[this.count].classList.add('active');
    this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
  }

  autoClick() {
    this.sliderRounds.forEach(btn => {
      btn.classList.remove('active');
    });
    this.count++;

    if (this.count >= this.sliderRounds.length) {
      this.count = 0;
      this.translate();
    } else {
      this.translate();
    }
  }

  handleTouchStart(e) {
    let touch = e.touches[0];
    this.x1 = touch.clientX;
    this.y1 = touch.clientY;
  }

  handleTouchMove(e) {
    if (!(this.x1 || this.y1)) {
      return false;
    }

    let touch = e.touches[0];
    let x2 = touch.clientX;
    let y2 = touch.clientY;
    let xDiff = x2 - this.x1;
    let yDiff = y2 - this.y1; // console.log(this.x1, x2);

    if (xDiff > 0) {
      //r
      this.sliderRounds.forEach(btn => {
        btn.classList.remove('active');
      });
      this.count--;

      if (this.count < 0) {
        this.count = this.sliderRounds.length - 1;
        this.sliderRounds[this.count].classList.add('active');
        this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
      }

      this.sliderRounds[this.count].classList.add('active');
      this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
    } else {
      //l
      this.autoClick();
    }

    this.x1 = null;
    this.y1 = null;
    this.intervalId = this.interval();
  }

  interval() {
    let id = setInterval(() => {
      this.autoClick();
    }, 3000);
    return id;
  }

}

let slider = new Slider();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNsaWRlci5qcyJdLCJuYW1lcyI6WyJTbGlkZXIiLCJjb25zdHJ1Y3RvciIsInNsaWRlcklubmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic2xpZGVyTGluZSIsInNsaWRlclNsaWRlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzbGlkZXJQYWdpbmF0aW9uIiwic2xpZGVyUm91bmRzIiwiY291bnQiLCJ4MSIsInkxIiwiaW5pdCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2hhbmdlIiwiaW50ZXJ2YWxJZCIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiYXV0b0NsaWNrIiwiaGFuZGxlVG91Y2hTdGFydCIsImhhbmRsZVRvdWNoTW92ZSIsIndpZHRoIiwib2Zmc2V0V2lkdGgiLCJzdHlsZSIsImxlbmd0aCIsImZvckVhY2giLCJpdGVtIiwiaGVpZ2h0IiwidGFyZ2V0IiwiYnRuIiwiaW5kZXgiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0cmFuc2xhdGUiLCJhZGQiLCJ0cmFuc2Zvcm0iLCJ0b3VjaCIsInRvdWNoZXMiLCJjbGllbnRYIiwiY2xpZW50WSIsIngyIiwieTIiLCJ4RGlmZiIsInlEaWZmIiwiaWQiLCJzbGlkZXIiXSwibWFwcGluZ3MiOiJBQUVBLE1BQUFBLE1BQUEsQ0FBQTtBQUNBQyxFQUFBQSxXQUFBLEdBQUE7QUFDQSxTQUFBQyxXQUFBLEdBQUFDLFFBQUEsQ0FBQUMsYUFBQSxDQUFBLGdCQUFBLENBQUE7QUFDQSxTQUFBQyxVQUFBLEdBQUEsS0FBQUgsV0FBQSxDQUFBRSxhQUFBLENBQUEsZUFBQSxDQUFBO0FBQ0EsU0FBQUUsWUFBQSxHQUFBLENBQUEsR0FBQSxLQUFBRCxVQUFBLENBQUFFLGdCQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBO0FBQ0EsU0FBQUMsZ0JBQUEsR0FBQSxLQUFBTixXQUFBLENBQUFFLGFBQUEsQ0FBQSxxQkFBQSxDQUFBO0FBQ0EsU0FBQUssWUFBQSxHQUFB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LEtBQUEsR0FBQSxLQUFBRCxZQUFBLENBQUFtQixNQUFBLEdBQUEsQ0FBQTtBQUVBLGFBQUFuQixZQUFBLENBQUEsS0FBQUMsS0FBQSxFQUFBeUIsU0FBQSxDQUFBRyxHQUFBLENBQUEsUUFBQTtBQUNBLGFBQUFqQyxVQUFBLENBQUFzQixLQUFBLENBQUFZLFNBQUEsR0FBQSxlQUFBLEtBQUE3QixLQUFBLEdBQUEsS0FBQWUsS0FBQSxLQUFBO0FBRUE7O0FBQ0EsV0FBQWhCLFlBQUEsQ0FBQSxLQUFBQyxLQUFBLEVBQUF5QixTQUFBLENBQUFHLEdBQUEsQ0FBQSxRQUFBO0FBQ0EsV0FBQWpDLFVBQUEsQ0FBQXNCLEtBQUEsQ0FBQVksU0FBQSxHQUFBLGVBQUEsS0FBQTdCLEtBQUEsR0FBQSxLQUFBZSxLQUFBLEtBQUE7QUFHQSxLQW5CQSxNQW1CQTtBQUNBO0FBRUEsV0FBQUgsU0FBQTtBQUNBOztBQUdBLFNBQUFYLEVBQUEsR0FBQSxJQUFBO0FBQ0EsU0FBQUMsRUFBQSxHQUFBLElBQUE7QUFFQSxTQUFBTSxVQUFBLEdBQUEsS0FBQUMsUUFBQSxFQUFBO0FBQ0E7O0FBR0FBLEVBQUFBLFFBQUEsR0FBQTtBQUNBLFFBQUE2QixFQUFBLEdBQUEzQixXQUFBLENBQUEsTUFBQTtBQUNBLFdBQUFDLFNBQUE7QUFDQSxLQUZBLEVBRUEsSUFGQSxDQUFBO0FBSUEsV0FBQTBCLEVBQUE7QUFDQTs7QUEvS0E7O0FBa0xBLElBQUFDLE1BQUEsR0FBQSxJQUFBakQsTUFBQSxFQUFBIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmNsYXNzIFNsaWRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnNsaWRlcklubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNsaWRlcl9faW5uZXInKTtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUgPSB0aGlzLnNsaWRlcklubmVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX2xpbmUnKTtcclxuICAgICAgICB0aGlzLnNsaWRlclNsaWRlcyA9IFsuLi50aGlzLnNsaWRlckxpbmUucXVlcnlTZWxlY3RvckFsbCgnLnNsaWRlcl9fc2xpZGUnKV07XHJcbiAgICAgICAgdGhpcy5zbGlkZXJQYWdpbmF0aW9uID0gdGhpcy5zbGlkZXJJbm5lci5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19wYWdpbmF0aW9uJyk7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJSb3VuZHMgPSBbLi4udGhpcy5zbGlkZXJJbm5lci5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19yb3VuZCcpXTtcclxuXHJcbiAgICAgICAgdGhpcy5jb3VudCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMueDEgPSBudWxsO1xyXG4gICAgICAgIHRoaXMueTEgPSBudWxsO1xyXG5cclxuXHJcblxyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBDbGljay8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgdGhpcy5pbml0KClcclxuXHJcblxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdCgpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJQYWdpbmF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2UoZSlcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEludGVydmFsLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gdGhpcy5pbnRlcnZhbCgpOyBcclxuXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyUGFnaW5hdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuc2xpZGVyUGFnaW5hdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRvQ2xpY2soKTtcclxuICAgICAgICAgICAgfSwgMzAwMCk7XHJcbiAgICAgICAgfSlcclxuXHJcblxyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBUb3VjaC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVySW5uZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlVG91Y2hTdGFydChlKTtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJJbm5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZVRvdWNoTW92ZShlKTtcclxuICAgICAgICB9LCBmYWxzZSk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5zbGlkZXJJbm5lci5vZmZzZXRXaWR0aDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUud2lkdGggPSB0aGlzLndpZHRoICogdGhpcy5zbGlkZXJTbGlkZXMubGVuZ3RoICsgJ3B4JztcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJTbGlkZXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGl0ZW0uc3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlKGUpIHtcclxuICAgICAgICBpZiAoZS50YXJnZXQgIT0gdGhpcy5zbGlkZXJQYWdpbmF0aW9uKSB7XHJcblxyXG5cclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJSb3VuZHMuZm9yRWFjaCgoYnRuLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gYnRuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudCA9IGluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgdHJhbnNsYXRlKCkge1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3RoaXMuY291bnQgKiB0aGlzLndpZHRofXB4KWA7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGF1dG9DbGljaygpIHtcclxuICAgICAgICB0aGlzLnNsaWRlclJvdW5kcy5mb3JFYWNoKGJ0biA9PiB7XHJcbiAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNvdW50Kys7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvdW50ID49IHRoaXMuc2xpZGVyUm91bmRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gMDtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVG91Y2hTdGFydChlKSB7XHJcblxyXG4gICAgICAgIGxldCB0b3VjaCA9IGUudG91Y2hlc1swXTtcclxuICAgICAgICB0aGlzLngxID0gdG91Y2guY2xpZW50WDtcclxuICAgICAgICB0aGlzLnkxID0gdG91Y2guY2xpZW50WTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZVRvdWNoTW92ZShlKSB7XHJcblxyXG4gICAgICAgIGlmICghKHRoaXMueDEgfHwgdGhpcy55MSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgdG91Y2ggPSBlLnRvdWNoZXNbMF07XHJcblxyXG4gICAgICAgIGxldCB4MiA9IHRvdWNoLmNsaWVudFg7XHJcbiAgICAgICAgbGV0IHkyID0gdG91Y2guY2xpZW50WTtcclxuXHJcblxyXG5cclxuICAgICAgICBsZXQgeERpZmYgPSB4MiAtIHRoaXMueDE7XHJcbiAgICAgICAgbGV0IHlEaWZmID0geTIgLSB0aGlzLnkxO1xyXG5cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLngxLCB4Mik7XHJcblxyXG4gICAgICAgIGlmICh4RGlmZiA+IDApIHtcclxuICAgICAgICAgICAgLy9yXHJcblxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kcy5mb3JFYWNoKGJ0biA9PiB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvdW50LS07XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvdW50IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudCA9IHRoaXMuc2xpZGVyUm91bmRzLmxlbmd0aCAtIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zbGlkZXJSb3VuZHNbdGhpcy5jb3VudF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7dGhpcy5jb3VudCAqIHRoaXMud2lkdGh9cHgpYDtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJSb3VuZHNbdGhpcy5jb3VudF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHt0aGlzLmNvdW50ICogdGhpcy53aWR0aH1weClgO1xyXG5cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy9sXHJcblxyXG4gICAgICAgICAgICB0aGlzLmF1dG9DbGljaygpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMueDEgPSBudWxsO1xyXG4gICAgICAgIHRoaXMueTEgPSBudWxsO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHRoaXMuaW50ZXJ2YWwoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgaW50ZXJ2YWwoKXtcclxuICAgICAgbGV0IGlkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9DbGljaygpO1xyXG4gICAgICAgIH0sIDMwMDApO1xyXG5cclxuICAgICAgICByZXR1cm4gaWQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmxldCBzbGlkZXIgPSBuZXcgU2xpZGVyKCk7Il19
