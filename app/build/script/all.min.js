class Heart {
  constructor() {
    this.hearts = [...document.querySelectorAll('.cards__heart')];
    this.hearts.forEach(heart => {
      heart.addEventListener('click', e => {
        this.change(e, heart);
      });
    });
  }

  change(e) {
    if (e.target.dataset.flag === 'true') {
      e.target.src = '../images/heart.svg';
      e.target.dataset.flag = false;
    } else {
      e.target.setAttribute('data-flag', true);
      e.target.src = '../images/heartRed.svg';
    }
  }

}

const heart = new Heart();
let langArrow = document.querySelector('.prenav__langs-arrow');
let langBox = document.querySelector('.prenav__langs-box');
langBox.addEventListener('mouseover', () => {
  langArrow.style.transform = "rotateX(180deg)";
  langArrow.style.transition = "all ease 0.5s";
});
langBox.addEventListener('mouseout', () => {
  langArrow.style.transform = "rotateX(0deg)";
  langArrow.style.transition = "all ease 0.5s";
});

class Burger {
  constructor() {
    this.btn = document.querySelector('.prenav__burger');
    this.prenav = document.querySelector('.prenav');
    this.arrow = document.querySelector('.prenav__burger');
    this.prenav.style.transition = '0.8s all ease';
    this.arrow.style.transition = '0.8s all ease';
    this.btn.addEventListener('click', e => {
      this.open(e);
    });
  }

  open(e) {
    if (e.target.classList.contains('active')) {
      e.target.classList.remove('active');
      this.prenav.style.minHeight = '50px';
      this.arrow.style.transform = 'rotateX(0deg)';
    } else {
      this.prenav.style.minHeight = '190px';
      e.target.classList.add('active');
      this.arrow.style.transform = 'rotateX(180deg)';
    }
  }

}

const burger = new Burger();

class ImageSwitcher {
  constructor(obj) {
    this.imageItems = [...document.querySelectorAll(obj.imageItems)];
    this.miniImages = [...document.querySelectorAll(obj.miniImages)];
    this.images = [...document.querySelectorAll(obj.images)];
    this.current = 0;
    this.imageItems.forEach(item => {
      item.addEventListener('click', e => {
        this.switch(e);
      });
    });
  }

  switch(e) {
    this.imageItems.forEach(item => {
      item.classList.remove('active');
    });
    this.images.forEach(item => {
      item.classList.remove('active');
    });
    this.current = this.miniImages.indexOf(e.target);
    this.imageItems[this.current].classList.add('active');
    this.images[this.current].classList.add('active');
  }

}

const imageSwitcher = new ImageSwitcher({
  imageItems: '.item__box-item',
  images: '.item__mainImg',
  miniImages: '.item__miniImg'
});

class Slider {
  constructor() {
    this.sliderInner = document.querySelector('.slider__inner');
    this.sliderLine = this.sliderInner.querySelector('.slider__line');
    this.sliderSlides = [...this.sliderLine.querySelectorAll('.slider__slide')];
    this.sliderPagination = this.sliderInner.querySelector('.slider__pagination');
    this.sliderRounds = [...this.sliderInner.querySelectorAll('.slider__round')];
    this.count = 0;
    this.x1 = null;
    this.y1 = null; //////////////////////// Click//////////////////////////

    this.init();
    window.addEventListener('resize', () => {
      this.init();
    });
    this.sliderPagination.addEventListener('click', e => {
      this.change(e);
    }); //////////////////////// Interval//////////////////////////

    this.intervalId = this.interval();
    this.sliderPagination.addEventListener('mouseover', () => {
      clearInterval(this.intervalId);
    });
    this.sliderPagination.addEventListener('mouseout', () => {
      this.intervalId = setInterval(() => {
        this.autoClick();
      }, 3000);
    }); //////////////////////// Touch//////////////////////////

    this.sliderInner.addEventListener('touchstart', e => {
      this.handleTouchStart(e);
      clearInterval(this.intervalId);
    }, false);
    this.sliderInner.addEventListener('touchmove', e => {
      this.handleTouchMove(e);
    }, false);
  }

  init() {
    this.width = this.sliderInner.offsetWidth;
    this.sliderLine.style.width = this.width * this.sliderSlides.length + 'px';
    this.sliderSlides.forEach(item => {
      item.style.width = this.width + 'px';
      item.style.height = 'auto';
    });
  }

  change(e) {
    if (e.target != this.sliderPagination) {
      this.sliderRounds.forEach((btn, index) => {
        btn.classList.remove('active');

        if (e.target === btn) {
          this.count = index;
          this.translate();
        }
      });
    }
  }

  translate() {
    this.sliderRounds[this.count].classList.add('active');
    this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
  }

  autoClick() {
    this.sliderRounds.forEach(btn => {
      btn.classList.remove('active');
    });
    this.count++;

    if (this.count >= this.sliderRounds.length) {
      this.count = 0;
      this.translate();
    } else {
      this.translate();
    }
  }

  handleTouchStart(e) {
    let touch = e.touches[0];
    this.x1 = touch.clientX;
    this.y1 = touch.clientY;
  }

  handleTouchMove(e) {
    if (!(this.x1 || this.y1)) {
      return false;
    }

    let touch = e.touches[0];
    let x2 = touch.clientX;
    let y2 = touch.clientY;
    let xDiff = x2 - this.x1;
    let yDiff = y2 - this.y1; // console.log(this.x1, x2);

    if (xDiff > 0) {
      //r
      this.sliderRounds.forEach(btn => {
        btn.classList.remove('active');
      });
      this.count--;

      if (this.count < 0) {
        this.count = this.sliderRounds.length - 1;
        this.sliderRounds[this.count].classList.add('active');
        this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
      }

      this.sliderRounds[this.count].classList.add('active');
      this.sliderLine.style.transform = `translateX(-${this.count * this.width}px)`;
    } else {
      //l
      this.autoClick();
    }

    this.x1 = null;
    this.y1 = null;
    this.intervalId = this.interval();
  }

  interval() {
    let id = setInterval(() => {
      this.autoClick();
    }, 3000);
    return id;
  }

}

let slider = new Slider();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2ZUhlYXJ0LmpzIiwiYXJyb3ctZG93bi5qcyIsImJ1cmdlci5qcyIsImltYWdlU3dpdGNoZXIuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsiSGVhcnQiLCJjb25zdHJ1Y3RvciIsImhlYXJ0cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJoZWFydCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2hhbmdlIiwidGFyZ2V0IiwiZGF0YXNldCIsImZsYWciLCJzcmMiLCJzZXRBdHRyaWJ1dGUiLCJsYW5nQXJyb3ciLCJxdWVyeVNlbGVjdG9yIiwibGFuZ0JveCIsInN0eWxlIiwidHJhbnNmb3JtIiwidHJhbnNpdGlvbiIsIkJ1cmdlciIsImJ0biIsInByZW5hdiIsImFycm93Iiwib3BlbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwibWluSGVpZ2h0IiwiYWRkIiwiYnVyZ2VyIiwiSW1hZ2VTd2l0Y2hlciIsIm9iaiIsImltYWdlSXRlbXMiLCJtaW5pSW1hZ2VzIiwiaW1hZ2VzIiwiY3VycmVudCIsIml0ZW0iLCJzd2l0Y2giLCJpbmRleE9mIiwiaW1hZ2VTd2l0Y2hlciIsIlNsaWRlciIsInNsaWRlcklubmVyIiwic2xpZGVyTGluZSIsInNsaWRlclNsaWRlcyIsInNsaWRlclBhZ2luYXRpb24iLCJzbGlkZXJSb3VuZHMiLCJjb3VudCIsIngxIiwieTEiLCJpbml0Iiwid2luZG93IiwiaW50ZXJ2YWxJZCIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiYXV0b0NsaWNrIiwiaGFuZGxlVG91Y2hTdGFydCIsImhhbmRsZVRvdWNoTW92ZSIsIndpZHRoIiwib2Zmc2V0V2lkdGgiLCJsZW5ndGgiLCJoZWlnaHQiLCJpbmRleCIsInRyYW5zbGF0ZSIsInRvdWNoIiwidG91Y2hlcyIsImNsaWVudFgiLCJjbGllbnRZIiwieDIiLCJ5MiIsInhEaWZmIiwieURpZmYiLCJpZCIsInNs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QUFBO0FBRUE7O0FBQ0EsV0FBQWIsWUFBQSxDQUFBLEtBQUFDLEtBQUEsRUFBQXRCLFNBQUEsQ0FBQUksR0FBQSxDQUFBLFFBQUE7QUFDQSxXQUFBYyxVQUFBLENBQUExQixLQUFBLENBQUFDLFNBQUEsR0FBQSxlQUFBLEtBQUE2QixLQUFBLEdBQUEsS0FBQVksS0FBQSxLQUFBO0FBR0EsS0FuQkEsTUFtQkE7QUFDQTtBQUVBLFdBQUFILFNBQUE7QUFDQTs7QUFHQSxTQUFBUixFQUFBLEdBQUEsSUFBQTtBQUNBLFNBQUFDLEVBQUEsR0FBQSxJQUFBO0FBRUEsU0FBQUcsVUFBQSxHQUFBLEtBQUFDLFFBQUEsRUFBQTtBQUNBOztBQUdBQSxFQUFBQSxRQUFBLEdBQUE7QUFDQSxRQUFBb0IsRUFBQSxHQUFBbEIsV0FBQSxDQUFBLE1BQUE7QUFDQSxXQUFBQyxTQUFBO0FBQ0EsS0FGQSxFQUVBLElBRkEsQ0FBQTtBQUlBLFdBQUFpQixFQUFBO0FBQ0E7O0FBL0tBOztBQWtMQSxJQUFBQyxNQUFBLEdBQUEsSUFBQWpDLE1BQUEsRUFBQSIsImZpbGUiOiJhbGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmNsYXNzIEhlYXJ0IHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuaGVhcnRzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJkc19faGVhcnQnKV07XHJcblxyXG4gICAgICAgXHJcbiAgICAgICAgdGhpcy5oZWFydHMuZm9yRWFjaChoZWFydCA9PntcclxuICAgICAgICAgICAgaGVhcnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2UoZSwgaGVhcnQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlKGUpIHtcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBpZihlLnRhcmdldC5kYXRhc2V0LmZsYWcgPT09ICd0cnVlJyl7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnNyYz0gJy4uL2ltYWdlcy9oZWFydC5zdmcnXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LmRhdGFzZXQuZmxhZyA9IGZhbHNlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZmxhZycsIHRydWUpXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnNyYz0gJy4uL2ltYWdlcy9oZWFydFJlZC5zdmcnXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuY29uc3QgaGVhcnQgPSBuZXcgSGVhcnQoKTtcclxuIiwibGV0IGxhbmdBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVuYXZfX2xhbmdzLWFycm93Jyk7XHJcbmxldCBsYW5nQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZW5hdl9fbGFuZ3MtYm94Jyk7XHJcblxyXG5sYW5nQm94LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+e1xyXG5cclxuICAgIGxhbmdBcnJvdy5zdHlsZS50cmFuc2Zvcm0gPVwicm90YXRlWCgxODBkZWcpXCI7XHJcbiAgICBsYW5nQXJyb3cuc3R5bGUudHJhbnNpdGlvbiA9XCJhbGwgZWFzZSAwLjVzXCI7XHJcblxyXG5cclxufSlcclxuXHJcbmxhbmdCb3guYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCAoKSA9PntcclxuXHJcbiAgICAgICAgbGFuZ0Fycm93LnN0eWxlLnRyYW5zZm9ybSA9XCJyb3RhdGVYKDBkZWcpXCI7XHJcbiAgICAgICAgbGFuZ0Fycm93LnN0eWxlLnRyYW5zaXRpb24gPVwiYWxsIGVhc2UgMC41c1wiO1xyXG5cclxuXHJcbn0pIiwiY2xhc3MgQnVyZ2Vye1xyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICB0aGlzLmJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVuYXZfX2J1cmdlcicpO1xyXG4gICAgICAgIHRoaXMucHJlbmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZW5hdicpO1xyXG4gICAgICAgIHRoaXMuYXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJlbmF2X19idXJnZXInKTtcclxuXHJcbiAgICAgICAgdGhpcy5wcmVuYXYuc3R5bGUudHJhbnNpdGlvbiA9ICcwLjhzIGFsbCBlYXNlJztcclxuICAgICAgICB0aGlzLmFycm93LnN0eWxlLnRyYW5zaXRpb24gPSAnMC44cyBhbGwgZWFzZSc7XHJcbiAgICAgICBcclxuXHJcbiAgICAgICAgdGhpcy5idG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PntcclxuICAgICAgICAgICAgdGhpcy5vcGVuKGUpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBvcGVuKGUpe1xyXG4gICAgICAgIFxyXG4gICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSl7XHJcbiAgICAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgdGhpcy5wcmVuYXYuc3R5bGUubWluSGVpZ2h0ID0gJzUwcHgnO1xyXG4gICAgICAgICAgIHRoaXMuYXJyb3cuc3R5bGUudHJhbnNmb3JtID0ncm90YXRlWCgwZGVnKSdcclxuICAgICAgIH0gZWxzZXtcclxuICAgICAgICB0aGlzLnByZW5hdi5zdHlsZS5taW5IZWlnaHQgPSAnMTkwcHgnO1xyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHRoaXMuYXJyb3cuc3R5bGUudHJhbnNmb3JtID0ncm90YXRlWCgxODBkZWcpJ1xyXG4gICAgICAgfVxyXG4gICAgICAgXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IGJ1cmdlciA9IG5ldyBCdXJnZXIoKTtcclxuXHJcblxyXG4iLCJjbGFzcyBJbWFnZVN3aXRjaGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG9iaikge1xyXG4gICAgICAgIHRoaXMuaW1hZ2VJdGVtcyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9iai5pbWFnZUl0ZW1zKV07XHJcbiAgICAgICAgdGhpcy5taW5pSW1hZ2VzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob2JqLm1pbmlJbWFnZXMpXTtcclxuICAgICAgICB0aGlzLmltYWdlcyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9iai5pbWFnZXMpXTtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5pbWFnZUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3dpdGNoKGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzd2l0Y2goZSkge1xyXG5cclxuICAgICAgICB0aGlzLmltYWdlSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmltYWdlcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSB0aGlzLm1pbmlJbWFnZXMuaW5kZXhPZihlLnRhcmdldCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW1hZ2VJdGVtc1t0aGlzLmN1cnJlbnRdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHRoaXMuaW1hZ2VzW3RoaXMuY3VycmVudF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcblxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5jb25zdCBpbWFnZVN3aXRjaGVyID0gbmV3IEltYWdlU3dpdGNoZXIoXHJcbiAgICB7XHJcbiAgICAgICAgaW1hZ2VJdGVtczogJy5pdGVtX19ib3gtaXRlbScsXHJcbiAgICAgICAgaW1hZ2VzOiAnLml0ZW1fX21haW5JbWcnLFxyXG4gICAgICAgIG1pbmlJbWFnZXM6ICcuaXRlbV9fbWluaUltZycsXHJcbiAgICB9XHJcbikiLCJcclxuY2xhc3MgU2xpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVySW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19pbm5lcicpO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZSA9IHRoaXMuc2xpZGVySW5uZXIucXVlcnlTZWxlY3RvcignLnNsaWRlcl9fbGluZScpO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyU2xpZGVzID0gWy4uLnRoaXMuc2xpZGVyTGluZS5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19zbGlkZScpXTtcclxuICAgICAgICB0aGlzLnNsaWRlclBhZ2luYXRpb24gPSB0aGlzLnNsaWRlcklubmVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX3BhZ2luYXRpb24nKTtcclxuICAgICAgICB0aGlzLnNsaWRlclJvdW5kcyA9IFsuLi50aGlzLnNsaWRlcklubmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZXJfX3JvdW5kJyldO1xyXG5cclxuICAgICAgICB0aGlzLmNvdW50ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy54MSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy55MSA9IG51bGw7XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIENsaWNrLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgICAgICB0aGlzLmluaXQoKVxyXG5cclxuXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pbml0KClcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICB0aGlzLnNsaWRlclBhZ2luYXRpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZShlKVxyXG4gICAgICAgIH0pXHJcblxyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gSW50ZXJ2YWwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgICAgICB0aGlzLmludGVydmFsSWQgPSB0aGlzLmludGVydmFsKCk7IFxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJQYWdpbmF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5zbGlkZXJQYWdpbmF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9DbGljaygpO1xyXG4gICAgICAgICAgICB9LCAzMDAwKTtcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFRvdWNoLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJJbm5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVUb3VjaFN0YXJ0KGUpO1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XHJcbiAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlcklubmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlVG91Y2hNb3ZlKGUpO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIHRoaXMud2lkdGggPSB0aGlzLnNsaWRlcklubmVyLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKiB0aGlzLnNsaWRlclNsaWRlcy5sZW5ndGggKyAncHgnO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlclNsaWRlcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgICBpdGVtLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcclxuXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2UoZSkge1xyXG4gICAgICAgIGlmIChlLnRhcmdldCAhPSB0aGlzLnNsaWRlclBhZ2luYXRpb24pIHtcclxuXHJcblxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kcy5mb3JFYWNoKChidG4sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSBidG4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB0cmFuc2xhdGUoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzW3RoaXMuY291bnRdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7dGhpcy5jb3VudCAqIHRoaXMud2lkdGh9cHgpYDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgYXV0b0NsaWNrKCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVyUm91bmRzLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY291bnQrKztcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY291bnQgPj0gdGhpcy5zbGlkZXJSb3VuZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY291bnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVUb3VjaFN0YXJ0KGUpIHtcclxuXHJcbiAgICAgICAgbGV0IHRvdWNoID0gZS50b3VjaGVzWzBdO1xyXG4gICAgICAgIHRoaXMueDEgPSB0b3VjaC5jbGllbnRYO1xyXG4gICAgICAgIHRoaXMueTEgPSB0b3VjaC5jbGllbnRZO1xyXG5cclxuXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVG91Y2hNb3ZlKGUpIHtcclxuXHJcbiAgICAgICAgaWYgKCEodGhpcy54MSB8fCB0aGlzLnkxKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB0b3VjaCA9IGUudG91Y2hlc1swXTtcclxuXHJcbiAgICAgICAgbGV0IHgyID0gdG91Y2guY2xpZW50WDtcclxuICAgICAgICBsZXQgeTIgPSB0b3VjaC5jbGllbnRZO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGxldCB4RGlmZiA9IHgyIC0gdGhpcy54MTtcclxuICAgICAgICBsZXQgeURpZmYgPSB5MiAtIHRoaXMueTE7XHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMueDEsIHgyKTtcclxuXHJcbiAgICAgICAgaWYgKHhEaWZmID4gMCkge1xyXG4gICAgICAgICAgICAvL3JcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVyUm91bmRzLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY291bnQtLTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY291bnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5zbGlkZXJSb3VuZHMubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHt0aGlzLmNvdW50ICogdGhpcy53aWR0aH1weClgO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlclJvdW5kc1t0aGlzLmNvdW50XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3RoaXMuY291bnQgKiB0aGlzLndpZHRofXB4KWA7XHJcblxyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvL2xcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0NsaWNrKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy54MSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy55MSA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gdGhpcy5pbnRlcnZhbCgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBpbnRlcnZhbCgpe1xyXG4gICAgICBsZXQgaWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0NsaWNrKCk7XHJcbiAgICAgICAgfSwgMzAwMCk7XHJcblxyXG4gICAgICAgIHJldHVybiBpZDtcclxuICAgIH1cclxufVxyXG5cclxubGV0IHNsaWRlciA9IG5ldyBTbGlkZXIoKTsiXX0=
